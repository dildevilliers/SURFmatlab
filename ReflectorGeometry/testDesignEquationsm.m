%==========================================================================================================================
%NOW WE TEST THE OFFSET EQUATIONS.
%==========================================================================================================================
th_0_1 = ODReq1(79.4,107.3)*180/pi
th_0_2 = ODReq1(58.7,82.8)*180/pi
th_0_3 = ODReq1(40,38)*180/pi
th_0_4 = ODReq1(18,18)*180/pi

th_U_1 = ODReq2(79.4,100,107.3)*180/pi
th_U_2 = ODReq2(58.7,100,82.8)*180/pi
th_U_3 = ODReq2(40,45,38)*180/pi
th_U_4 = ODReq2(18,24,18)*180/pi

%th_U = ODReq3(e,alpha,sigma,th_e,beta)
th_U_1 = ODReq3(2.52016,23.1295*pi/180,-1,11.8767*pi/180,10.1*pi/180)*180/pi
th_U_2 = ODReq3(0.492772,-15.8030*pi/180,1,11.9131*pi/180,5.4*pi/180)*180/pi
th_U_3 = ODReq3(1.84393,20.03109*pi/180,-1,10.32476*pi/180,6.0*pi/180)*180/pi
th_U_4 = ODReq3(0.54461,-18.83789*pi/180,1,11.50497*pi/180,5.6*pi/180)*180/pi

%th_U = ODReq3(e,alpha,sigma,th_e,beta)
th_L_1 = ODReq4(79.4,100,107.3)*180/pi
th_L_2 = ODReq4(58.7,100,82.8)*180/pi
th_L_3 = ODReq4(40.0,45,38)*180/pi
th_L_4 = ODReq4(18.0,24,18)*180/pi

%e = ODReq5(sigma,beta,th_0)
e_1 = ODReq5(-1,10.1*pi/180,-40.608*pi/180)
e_2 = ODReq5(1,5.4*pi/180,-39.0356*pi/180)
e_3 = ODReq5(-1,6.0*pi/180,-55.51708*pi/180)
e_4 = ODReq5(1,5.6*pi/180,-53.13010*pi/180)

alpha_1 = ODReq6(2.52016,10.1*pi/180)*180/pi
alpha_2 = ODReq6(0.492772,5.4*pi/180)*180/pi
alpha_3 = ODReq6(1.84393,6.0*pi/180)*180/pi
alpha_4 = ODReq6(0.54461,5.6*pi/180)*180/pi

%ODReq7(sigma,e,th_U,beta,alpha)
th_e_1 = ODReq7(-1,2.52016,-62.1785*pi/180,10.1*pi/180,23.1295*pi/180)*180/pi
th_e_2 = ODReq7(1,0.492772,-66.5619*pi/180,5.4*pi/180,-15.8030*pi/180)*180/pi
th_e_3 = ODReq7(-1,1.84393,-78.8656*pi/180,6.0*pi/180,20.03109*pi/180)*180/pi
th_e_4 = ODReq7(1,0.54461,-79.61115*pi/180,5.6*pi/180,-18.83789*pi/180)*180/pi

Ls_1 = ODReq8(6.8966,2.52016,10.1*pi/180,-40.608*pi/180)
Ls_2 = ODReq8(28.6477,0.492772,5.4*pi/180,-39.0356*pi/180)
Ls_3 = ODReq8(6.42302,1.84393,6.0*pi/180,-55.51708*pi/180)
Ls_4 = ODReq8(21.04264,0.54461,5.6*pi/180,-53.13010*pi/180)

Lm_1 = ODReq9(6.8966,2.52016,10.1*pi/180,-40.608*pi/180,79.4)
Lm_2 = ODReq9(28.6477,0.492772,5.4*pi/180,-39.0356*pi/180,58.7)
Lm_3 = ODReq9(6.42302,1.84393,6.0*pi/180,-55.51708*pi/180,40.0)
Lm_4 = ODReq9(21.04264,0.54461,5.6*pi/180,-53.13010*pi/180,18.0)

%function dFPR = ODReq10(h,Dm,F,beta)
dFPR_1 = ODReq10(79.4,100,17.3805,10.1*pi/180)
dFPR_2 = ODReq10(58.7,100,14.1168,5.4*pi/180)
dFPR_3 = ODReq10(40.0,45,11.84361,6.0*pi/180)
dFPR_4 = ODReq10(18.0,24,11.46003,5.6*pi/180)

dSRPR_1 = ODReq11(79.4,100,6.8966,-1,2.52016,-62.1785*pi/180,10.1*pi/180,-15.6018*pi/180)
dSRPR_2 = ODReq11(58.7,100,28.6477,1,0.492772,-66.5619*pi/180,5.4*pi/180,-6.01468*pi/180)
dSRPR_3 = ODReq11(40.0,45,6.42302,-1,1.84393,-78.8656*pi/180,6.0*pi/180,-25.93417*pi/180)
dSRPR_4 = ODReq11(18.0,24,21.04264,1,0.54461,-79.61115*pi/180,5.6*pi/180,-18.92464*pi/180)

%Lt = ODReq12(a,sigma,e,th_L,beta,th_U,Dm,F,h)
Lt_1 = ODReq12(6.8966,-1,2.52016,-15.6018*pi/180,10.1*pi/180,-62.1785*pi/180,100,107.3,79.4)
Lt_2 = ODReq12(28.6477,1,0.492772,-6.01468*pi/180,5.4*pi/180,-66.5619*pi/180,100,82.8,58.7)
Lt_3 = ODReq12(6.42302,-1,1.84393,-25.93417*pi/180,6.0*pi/180,-78.8656*pi/180,45,38.0,40.0)
Lt_4 = ODReq12(21.04264,1,0.54461,-18.92464*pi/180,5.6*pi/180,-79.61115*pi/180,24,18.0,18.0)

%Ht = ODReq13(h,Dm,a,sigma,e,th_L,beta,th_U)
Ht_1 = ODReq13(79.4,100,6.8966,-1,2.52016,-15.6018*pi/180,10.1*pi/180,-62.1785*pi/180)
Ht_2 = ODReq13(58.7,100,28.6477,1,0.492772,-6.01468*pi/180,5.4*pi/180,-66.5619*pi/180)
Ht_3 = ODReq13(40.0,45,6.42302,-1,1.84393,-25.93417*pi/180,6.0*pi/180,-78.8656*pi/180)
Ht_4 = ODReq13(18.0,24,21.04264,1,0.54461,-18.92464*pi/180,5.6*pi/180,-79.61115*pi/180)

%Ht = ODReq14(Dm,dSRPR,Dsx,beta)
%ALMOST EQUAL, BUT NOT EXACTLY. DONT WORRY THIS IS RIGHT. IT IS AN
%APPROXIMATION.
Ht_1 = ODReq14(100,10.9297,15.0,10.1*pi/180)
Ht_2 = ODReq14(100,10.2326,15.0,5.4*pi/180)
Ht_3 = ODReq14(45,4.51682,10.0,6.0*pi/180)
Ht_4 = ODReq14(24,9.20998,10.0,5.6*pi/180)

%f = ODReq15(a,e)
f_1 = ODReq15(6.8966,2.52016)
f_2 = ODReq15(28.6477,0.492772)
f_3 = ODReq15(6.42302,1.84393)
f_4 = ODReq15(21.04264,0.54461)

%f = ODReq16(dFPR,h,Dm,beta)
f_1 = ODReq16(35.4959,79.4,100,10.1*pi/180)
f_2 = ODReq16(11.3570,58.7,100,5.4*pi/180)
f_3 = ODReq16(19.97599,40.0,45,6.0*pi/180)
f_4 = ODReq16(8.23661,18.0,24,5.6*pi/180)

%a = ODReq17(f,e)
a_1 = ODReq17(17.3805,2.52016)
a_2 = ODReq17(14.1168,0.492772)
a_3 = ODReq17(11.84361,1.84393)
a_4 = ODReq17(11.46003,0.54461)

%a = ODReq18(sigma,Dsx,e,beta,th_U,th_L)
a_1 = ODReq18(-1,15,2.52016,10.1*pi/180,-62.1785*pi/180,-15.6018*pi/180)
a_2 = ODReq18(1,15,0.492772,5.4*pi/180,-66.5619*pi/180,-6.01468*pi/180)
a_3 = ODReq18(-1,10,1.84393,6.0*pi/180,-78.8656*pi/180,-25.93417*pi/180)
a_4 = ODReq18(1,10,0.54461,5.6*pi/180,-79.61115*pi/180,-18.92464*pi/180)

%a = ODReq19(Lt,h,Dm,F,sigma,e,beta,th_U,th_L)
a_1 = ODReq19(95.539,79.4,100,107.3,-1,2.52016,10.1*pi/180,-62.1785*pi/180,-15.6018*pi/180)
a_2 = ODReq19(97.1173,58.7,100,82.8,1,0.492772,5.4*pi/180,-66.5619*pi/180,-6.01468*pi/180)
a_3 = ODReq19(33.42990,40.0,45,38.0,-1,1.84393,6.0*pi/180,-78.8656*pi/180,-25.93417*pi/180)
a_4 = ODReq19(26.86245,18.0,24,18.0,1,0.54461,5.6*pi/180,-79.61115*pi/180,-18.92464*pi/180)

%a = ODReq20(Ht,h,Dm,sigma,e,beta,th_U,th_L)
a_1 = ODReq20(126.365,79.4,100,-1,2.52016,10.1*pi/180,-62.1785*pi/180,-15.6018*pi/180)
a_2 = ODReq20(125.967,58.7,100,1,0.492772,5.4*pi/180,-66.5619*pi/180,-6.01468*pi/180)
a_3 = ODReq20(59.87143,40.0,45,-1,1.84393,6.0*pi/180,-78.8656*pi/180,-25.93417*pi/180)
a_4 = ODReq20(43.92561,18.0,24,1,0.54461,5.6*pi/180,-79.61115*pi/180,-18.92464*pi/180)

%a = ODReq21(dSRPR,h,Dm,sigma,e,beta,th_U,th_L)
a_1 = ODReq21(10.9297,79.4,100,-1,2.52016,10.1*pi/180,-62.1785*pi/180,-15.6018*pi/180)
a_2 = ODReq21(10.2326,58.7,100,1,0.492772,5.4*pi/180,-66.5619*pi/180,-6.01468*pi/180)
a_3 = ODReq21(4.51682,40.0,45,-1,1.84393,6.0*pi/180,-78.8656*pi/180,-25.93417*pi/180)
a_4 = ODReq21(9.20998,18.0,24,1,0.54461,5.6*pi/180,-79.61115*pi/180,-18.92464*pi/180)

%a = ODReq22(Ls,e,beta,th_0)
a_1 = ODReq22(28.0096,2.52016,10.1*pi/180,-40.608*pi/180)
a_2 = ODReq22(41.2498,0.492772,5.4*pi/180,-39.0356*pi/180)
a_3 = ODReq22(21.04870,1.84393,6.0*pi/180,-55.51708*pi/180)
a_4 = ODReq22(30.54596,0.54461,5.6*pi/180,-53.13010*pi/180)

%h = ODReq23(F,th_0)
h_1 = ODReq23(107.3,-40.608*pi/180)
h_2 = ODReq23(82.8,-39.0356*pi/180)
h_3 = ODReq23(38.0,-55.51708*pi/180)
h_4 = ODReq23(18.0,-53.13010*pi/180)

%h = ODReq24(dFPR,Dm,f,beta)
h_1 = ODReq24(35.4959,100,17.3805,10.1*pi/180)
h_2 = ODReq24(11.3570,100,14.1168,5.4*pi/180)
h_3 = ODReq24(19.97599,45,11.84361,6.0*pi/180)
h_4 = ODReq24(8.23661,24,11.46003,5.6*pi/180)

%F = ODReq25(h,th_0)
F_1 = ODReq25(79.4,-40.608*pi/180)
F_2 = ODReq25(58.7,-39.0356*pi/180)
F_3 = ODReq25(40.0,-55.51708*pi/180)
F_4 = ODReq25(18.0,-53.13010*pi/180)

%F = ODReq26(Dm,th_U,th_0)
F_1 = ODReq26(100,-62.1785*pi/180,-40.608*pi/180)
F_2 = ODReq26(100,-66.5619*pi/180,-39.0356*pi/180)
F_3 = ODReq26(45,-78.8656*pi/180,-55.51708*pi/180)
F_4 = ODReq26(24,-79.61115*pi/180,-53.13010*pi/180)

%Dsx = ODReq27(a,sigma,e,beta,th_U,th_L)
Dsx_1 = ODReq27(6.8966,-1,2.52016,10.1*pi/180,-62.1785*pi/180,-15.6018*pi/180)
Dsx_2 = ODReq27(28.6477,1,0.492772,5.4*pi/180,-66.5619*pi/180,-6.01468*pi/180)
Dsx_3 = ODReq27(6.42302,-1,1.84393,6.0*pi/180,-78.8656*pi/180,-25.93417*pi/180)
Dsx_4 = ODReq27(21.04264,1,0.54461,5.6*pi/180,-79.61115*pi/180,-18.92464*pi/180)

%C_SR = ODReq38(a,sigma,e,beta,th_U,th_L,th_e,alpha,f)
C_SR_1 = ODReq38(6.8966,-1,2.52016,10.1*pi/180,-62.1785*pi/180,-15.6018*pi/180,11.8767*pi/180,23.1295*pi/180,17.3805);
C_SR_2 = ODReq38(28.6477,1,0.492772,5.4*pi/180,-66.5619*pi/180,-6.01468*pi/180,11.9131*pi/180,-15.8030*pi/180,14.1168);
C_SR_3 = ODReq38(6.42302,-1,1.84393,6.0*pi/180,-78.8656*pi/180,-25.93417*pi/180,10.32476*pi/180,20.03109*pi/180,11.84361);
C_SR_4 = ODReq38(21.04264,1,0.54461,5.6*pi/180,-79.61115*pi/180,-18.92464*pi/180,11.50497*pi/180,-18.83789*pi/180,11.46003);

%Dsy = ODReq39(a,e,th_e,alpha)
Dsy_1 = ODReq39(6.8966,2.52016,11.8767*pi/180,23.1295*pi/180)
Dsy_2 = ODReq39(28.6477,0.492772,11.9131*pi/180,-15.8030*pi/180)
Dsy_3 = ODReq39(6.42302,1.84393,10.32476*pi/180,20.03109*pi/180)
Dsy_4 = ODReq39(21.04264,0.54461,11.50497*pi/180,-18.83789*pi/180)

%==========================================================================================================================
%NOW WE TEST THE SYMMETRIC (AND SYMMETRIC MINIMUM BLOCKAGE) EQUATIONS.
%==========================================================================================================================
th_0 = 0;
beta = 0;
sigma = 1;
th_ext = 0;
symFact_ext = 0;

Dm = 10;
Lm = 5;
th_e = deg2rad(25);
Ls = 2;
Df = 1;

DR = dualReflector(Dm,Lm,th_e,Ls,th_0,beta,sigma,th_ext,symFact_ext,Df);

%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRoption1(DR.Dm,DR.Lm,DR.Ls,DR.th_e,DR.sigma);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRoption2(DR.Dm,DR.F,DR.Lm,DR.th_e,DR.sigma);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRoption3(DR.Dm,DR.F,DR.Ls,DR.th_e,DR.sigma);
[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRoption4(DR.F,DR.Dsx,DR.Ls,DR.th_e,DR.sigma);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRoption5(DR.Lm,DR.Dsx,DR.Ls,DR.th_e,DR.sigma);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRoption6(DR.Dm,DR.F,DR.Dsx,DR.th_e,DR.sigma);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRoption7(DR.Dm,DR.Dsx,DR.Ls,DR.th_e,DR.sigma);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRmboption1(DR.Dm,DR.F,DR.Lm,DR.sigma);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRmboption2(DR.Dm,DR.F,DR.th_e);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRmboption3(DR.Dm,DR.F,DR.Dsx);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRmboption4(DR.Dm,DR.Lm,DR.Dsx);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRmboption5(DR.Dm,DR.Dsx,DR.th_e);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRmboption6(DR.Dm,DR.Lm,DR.th_e);
%[Dm,F,Lm,Ds,Ls,a,f,th_e] = SDRmboption7(DR.Dm,DR.Ls,DR.th_e);

error_Dm = DR.Dm - Dm
error_F = DR.F - F
error_Lm = DR.Lm - Lm
error_Ds = DR.Dsx - Ds
error_Ls = DR.Ls - Ls
error_a = DR.a - a
error_f = DR.f - f
error_th_e = DR.th_e - th_e
